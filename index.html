<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>MediaVault ‚Äì Minha cole√ß√£o</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- CSS -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="page-shell">
    <!-- TOPBAR -->
    <header class="topbar">
      <div class="topbar-inner">
        <div class="logo-area">
          <div class="logo-circle">MV</div>
          <div class="logo-text">
            <span class="logo-text-title">MediaVault</span>
            <span class="logo-text-sub">Seu hub pessoal de filmes & s√©ries</span>
          </div>
        </div>
        <div class="topbar-actions">
          <div class="chip">
            <span class="chip-dot"></span>
            <span>Supabase conectado</span>
          </div>
          <button id="btn-filtro-assistindo" type="button" class="btn btn-outline">
            <span>üé¨</span><span>Ir para aba ASSISTINDO</span>
          </button>
          <button id="btn-gerir-colecao" type="button" class="btn btn-outline">
            <span>üìö</span><span>Gerir Cole√ß√£o</span>
          </button>
        </div>
      </div>
    </header>

    <!-- OVERLAY DE CARREGAMENTO -->
    <div id="loading-overlay">
      <div class="loading-spinner"></div>
      <div class="loading-text">Carregando sua cole√ß√£o...</div>
    </div>

    <main>
      <div class="main-inner">
        <div id="message"></div>

        <!-- ============ VIEW PRINCIPAL ============ -->
        <section id="main-view" class="panel">
          <div class="panel-header">
            <div class="panel-title">
              <span class="icon">üìã</span>
              <span>Minha lista ‚Äì Filmes & S√©ries</span>
            </div>
          </div>

          <!-- FILTROS PRINCIPAIS -->
          <div class="filters-row">
            <div class="form-field">
              <label for="filtro-nome">Buscar por nome</label>
              <input id="filtro-nome" placeholder="Digite parte do nome" />
            </div>
            <div class="form-field">
              <label for="filtro-diretor">Diretor</label>
              <input id="filtro-diretor" placeholder="Nome do diretor" />
            </div>
            <div class="form-field">
              <label for="filtro-nota-min">M√≠nimo de estrelas</label>
              <select id="filtro-nota-min">
                <option value="">Qualquer</option>
                <option value="1">1 estrela</option>
                <option value="2">2 estrelas</option>
                <option value="3">3 estrelas</option>
                <option value="4">4 estrelas</option>
                <option value="5">5 estrelas</option>
              </select>
            </div>
            <div class="form-field">
              <label for="filtro-streaming">Streaming</label>
              <select id="filtro-streaming">
                <option value="">Todos</option>
              </select>
            </div>
            <div class="form-field">
              <label for="filtro-ano">Ano</label>
              <select id="filtro-ano">
                <option value="">Todos</option>
              </select>
            </div>
            <div class="form-field">
              <label for="filtro-genero">G√™nero</label>
              <select id="filtro-genero">
                <option value="">Todos</option>
              </select>
            </div>
            <div class="form-field">
              <label for="filtro-franquia">Franquia</label>
              <select id="filtro-franquia">
                <option value="">Todas</option>
              </select>
            </div>
            <div class="form-field" style="align-items:flex-start;">
              <button id="btn-limpar-filtros" type="button" class="btn btn-outline">
                <span>üßπ</span><span>Limpar filtros</span>
              </button>
            </div>
          </div>

          <!-- ABAS DE STATUS -->
          <div class="tabs-bar" id="tabs-bar">
            <button class="tab-status tab-status-active" data-status="">
              <span class="tab-dot"></span>
              <span>Todos</span>
              <span class="tab-count" id="tab-count-todos"></span>
            </button>
            <button class="tab-status" data-status="ASSISTINDO">
              <span class="tab-dot"></span>
              <span>Assistindo</span>
              <span class="tab-count" id="tab-count-assistindo"></span>
            </button>
            <button class="tab-status" data-status="ASSISTIDOS">
              <span class="tab-dot"></span>
              <span>Assistidos</span>
              <span class="tab-count" id="tab-count-assistidos"></span>
            </button>
            <button class="tab-status" data-status="NAO_COMECEI">
              <span class="tab-dot"></span>
              <span>Ainda n√£o comecei</span>
              <span class="tab-count" id="tab-count-nao-comecei"></span>
            </button>
          </div>

          <!-- LISTA DE M√çDIAS (GRADE) -->
          <div id="lista-midias" class="cards-grid"></div>
        </section>

        <!-- ============ TOPs ‚Äì S√ì NA P√ÅGINA PRINCIPAL ============ -->
        <section id="tops-panel" class="panel">
          <div class="panel-header">
            <div class="panel-title">
              <span class="icon">‚≠ê</span>
              <span>Destaques da cole√ß√£o</span>
            </div>
          </div>
          <div class="tops-grid">
            <div class="top-column">
              <div class="top-column-title">‚¨Ü Top 10 mais bem avaliados</div>
              <div id="top10-best" class="top10-list"></div>
            </div>
            <div class="top-column">
              <div class="top-column-title">‚¨á Top 10 menos avaliados</div>
              <div id="top10-worst" class="top10-list"></div>
            </div>
            <div class="top-column">
              <div class="top-column-title">üïí √öltimos 10 adicionados</div>
              <div id="top10-last" class="top10-list"></div>
            </div>
          </div>
        </section>

        <!-- ============ COLE√á√ïES DE FRANQUIAS ============ -->
        <section id="colecoes-panel" class="panel">
          <div class="panel-header">
            <div class="panel-title">
              <span class="icon">üéûÔ∏è</span>
              <span>Cole√ß√µes de franquias</span>
            </div>
          </div>
          <div id="colecoes-list" class="colecoes-grid"></div>
        </section>

        <!-- ============ VIEW GERIR COLE√á√ÉO (CADASTRO) ============ -->
        <section id="gerir-view" class="panel" style="display:none;">
          <div class="panel-header">
            <div class="panel-title">
              <span class="icon">‚öôÔ∏è</span>
              <span>Gerir cole√ß√£o ‚Äì Cadastro de m√≠dias</span>
            </div>
            <button id="btn-voltar-lista" type="button" class="btn btn-outline">
              <span>‚Üê</span><span>Voltar para lista</span>
            </button>
          </div>

          <form id="midia-form">
            <div class="form-field">
              <label for="nome">Nome</label>
              <input id="nome" placeholder="Ex: Matrix, Lost, Vingadores..." required />
            </div>
            <div class="form-field">
              <label for="diretor">Diretor(es)</label>
              <input id="diretor" placeholder="Ex: Lana Wachowski, Lilly Wachowski" />
            </div>
            <div class="form-field">
              <label for="genero">G√™nero</label>
              <input id="genero" placeholder="Ex: A√ß√£o, Fic√ß√£o cient√≠fica" />
            </div>
            <div class="form-field">
              <label for="data-lancamento">Data de lan√ßamento</label>
              <input id="data-lancamento" type="date" />
            </div>
            <div class="form-field">
              <label for="ano">Ano (autom√°tico)</label>
              <input id="ano" type="number" min="1900" max="2100" readonly />
            </div>
            <div class="form-field">
              <label for="streaming">Streaming</label>
              <input id="streaming" placeholder="Netflix, Prime, Disney+, etc." />
            </div>
            <div class="form-field">
              <label for="tipo">Filme ou S√©rie?</label>
              <select id="tipo" required>
                <option value="">Selecione</option>
                <option value="FILME">Filme</option>
                <option value="SERIE">S√©rie</option>
              </select>
            </div>
            <div class="form-field">
              <label for="franquia">Franquia (cole√ß√£o)</label>
              <input id="franquia" placeholder="Ex: Matrix, MCU, Star Wars..." />
            </div>
            <div class="form-field">
              <label for="status">Status</label>
              <select id="status" required>
                <option value="ASSISTINDO">ASSISTINDO</option>
                <option value="ASSISTIDOS">ASSISTIDOS</option>
                <option value="NAO_COMECEI">AINDA N√ÉO COMECEI</option>
              </select>
            </div>
            <div class="form-field">
              <label>Avalia√ß√£o geral (0 a 5 estrelas)</label>
              <div class="rating-wrapper">
                <div id="midia-rating-stars" class="rating-stars"></div>
                <input
                  id="avaliacao"
                  type="number"
                  min="0"
                  max="5"
                  step="0.5"
                  style="display:none;"
                />
              </div>
            </div>
            <div class="form-field">
              <label for="imagem-url">Link da imagem (poster/capa)</label>
              <input id="imagem-url" type="url" placeholder="https://exemplo.com/poster.jpg" />
            </div>
            <div class="form-field" style="align-items:flex-start;">
              <button type="submit" id="btn-salvar" class="btn btn-primary">
                <span>üíæ</span><span>Salvar</span>
              </button>
              <button
                type="button"
                id="btn-cancelar-edicao"
                class="btn btn-outline"
                style="display:none; margin-left:6px;"
              >
                <span>‚úñ</span><span>Cancelar edi√ß√£o</span>
              </button>
            </div>
          </form>

          <!-- IMPORT/EXPORT M√çDIAS -->
          <div class="midias-import">
            <div class="form-field">
              <label for="midia-import-file">Importar m√≠dias (JSON)</label>
              <input id="midia-import-file" type="file" accept="application/json" />
              <small>
                Campos: nome, diretor, genero, data_lancamento, ano (opcional),
                streaming, tipo, status, avaliacao (0‚Äì5, pode 3.5), imagem_url, franquia.
              </small>
            </div>
            <div class="form-field" style="align-items:flex-start;">
              <button type="button" id="btn-import-midia" class="btn btn-outline">
                <span>üì•</span><span>Importar JSON</span>
              </button>
              <button type="button" id="btn-export-midias-json" class="btn btn-outline" style="margin-top:6px;">
                <span>üì§</span><span>Exportar JSON</span>
              </button>
              <button type="button" id="btn-export-midias-csv" class="btn btn-outline" style="margin-top:6px;">
                <span>üìä</span><span>Exportar CSV</span>
              </button>
              <button type="button" id="btn-export-modelo-midia" class="btn btn-outline" style="margin-top:6px;">
                <span>üìÑ</span><span>Modelo JSON</span>
              </button>
            </div>
            <div>
              <small>Exemplo:<br>
                { "nome": "Matrix", "diretor": "Lana Wachowski, Lilly Wachowski", "genero": "A√ß√£o/Fic√ß√£o cient√≠fica",
                "data_lancamento": "1999-03-31", "streaming": "Max", "tipo": "FILME", "status": "ASSISTIDOS",
                "avaliacao": 4.5, "imagem_url": "https://...", "franquia": "Matrix" }
              </small>
            </div>
          </div>
        </section>

        <!-- ============ VIEW EPIS√ìDIOS ============ -->
        <section id="episodios-view" class="panel" style="display:none;">
          <div class="top-bar-episodios">
            <button id="btn-voltar" type="button" class="btn btn-outline">
              <span>‚Üê</span><span>Voltar para lista</span>
            </button>
            <div id="episodios-titulo-bar" class="episodios-titulo-bar"></div>
          </div>

          <div id="episodios-header" class="episodios-header"></div>

          <!-- FILTROS DE EPIS√ìDIOS -->
          <div class="episodios-filtros">
            <div class="form-field">
              <label for="filtro-ep-titulo">Buscar t√≠tulo do epis√≥dio</label>
              <input id="filtro-ep-titulo" placeholder="Digite parte do t√≠tulo" />
            </div>
            <div class="form-field">
              <label for="filtro-ep-status">Status dos epis√≥dios</label>
              <select id="filtro-ep-status">
                <option value="">Todos</option>
                <option value="ASSISTINDO">Assistindo</option>
                <option value="ASSISTIDOS">Assistidos</option>
                <option value="NAO_COMECEI">Ainda n√£o comecei</option>
              </select>
            </div>
          </div>

          <form id="episodio-form" class="episodios-form">
            <div class="form-field">
              <label for="ep-temp">Temporada</label>
              <input id="ep-temp" type="number" min="1" placeholder="Ex: 1" />
            </div>
            <div class="form-field">
              <label for="ep-num">Epis√≥dio</label>
              <input id="ep-num" type="number" min="1" placeholder="Ex: 3" />
            </div>
            <div class="form-field">
              <label for="ep-titulo">T√≠tulo (opcional)</label>
              <input id="ep-titulo" placeholder="Ex: Pilot" />
            </div>
            <div class="form-field">
              <label for="ep-resumo">Resumo do epis√≥dio</label>
              <textarea id="ep-resumo" rows="2" placeholder="Resumo breve do epis√≥dio"></textarea>
            </div>
            <div class="form-field">
              <label for="ep-status">Status do epis√≥dio</label>
              <select id="ep-status">
                <option value="ASSISTINDO">ASSISTINDO</option>
                <option value="ASSISTIDOS">ASSISTIDOS</option>
                <option value="NAO_COMECEI">AINDA N√ÉO COMECEI</option>
              </select>
            </div>
            <div class="form-field">
              <label>Avalia√ß√£o ep. (0 a 5 estrelas)</label>
              <div class="rating-wrapper">
                <div id="ep-rating-stars" class="rating-stars"></div>
                <input
                  id="ep-avaliacao"
                  type="number"
                  min="0"
                  max="5"
                  step="0.5"
                  style="display:none;"
                />
              </div>
            </div>
            <div class="form-field" style="align-items:flex-start;">
              <button type="submit" id="btn-salvar-episodio" class="btn btn-primary">
                <span>‚ûï</span><span>Adicionar epis√≥dio</span>
              </button>
              <button
                type="button"
                id="btn-cancelar-ep"
                class="btn btn-outline"
                style="display:none; margin-left:6px;"
              >
                <span>‚úñ</span><span>Cancelar edi√ß√£o ep.</span>
              </button>
            </div>
          </form>

          <!-- IMPORT / EXPORT JSON EPIS√ìDIOS -->
          <div class="episodios-import">
            <div class="form-field">
              <label for="ep-import-file">Importar epis√≥dios (JSON)</label>
              <input id="ep-import-file" type="file" accept="application/json" />
              <small>Campos: temporada, numero, titulo, resumo, status, avaliacao (0‚Äì5).</small>
            </div>
            <div class="form-field" style="align-items:flex-start;">
              <button type="button" id="btn-import-ep" class="btn btn-outline">
                <span>üì•</span><span>Importar JSON</span>
              </button>
              <button type="button" id="btn-export-modelo-ep" class="btn btn-outline" style="margin-top:6px;">
                <span>üìÑ</span><span>Modelo JSON</span>
              </button>
            </div>
            <div>
              <small>Exemplo:<br>
                { "temporada": 1, "numero": 1, "titulo": "Pilot", "resumo": "Queda do avi√£o",
                "status": "ASSISTIDOS", "avaliacao": 4.5 }
              </small>
            </div>
          </div>

          <div class="episodios-list" id="episodios-list"></div>
        </section>
      </div>
    </main>
  </div>

  <!-- JS -->
  <script src="app.js"></script>
</body>
</html>
