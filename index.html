<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Minha Cole√ß√£o de Filmes & S√©ries</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <div>
        <h1>üé¨ Minha Cole√ß√£o de Filmes & S√©ries</h1>
        <p class="subtitle">Controle o que voc√™ assiste, com notas, franquias e epis√≥dios.</p>
      </div>
      <nav class="header-actions">
        <button id="btn-ir-principal" class="btn secondary">Ir para aba Assistindo</button>
        <button id="btn-ir-gerir" class="btn primary">Gerir Cole√ß√£o</button>
      </nav>
    </header>

    <!-- ===================== VIEW PRINCIPAL (LISTA / DASHBOARD) ===================== -->
    <main id="view-principal" class="view active">
      <section class="filters-card">
        <h2>Filtrar m√≠dias</h2>
        <div class="filters-grid">
          <div class="form-field">
            <label for="filtro-busca-nome">Buscar por nome</label>
            <input id="filtro-busca-nome" type="text" placeholder="Ex: Lost, Matrix..." />
          </div>
          <div class="form-field">
            <label for="filtro-nota-min">Nota m√≠nima (‚≠ê)</label>
            <input id="filtro-nota-min" type="number" min="0" max="5" step="0.5" placeholder="Ex: 3.5" />
          </div>
          <div class="form-field">
            <label for="filtro-streaming">Streaming</label>
            <select id="filtro-streaming">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="form-field">
            <label for="filtro-ano">Ano</label>
            <select id="filtro-ano">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="form-field">
            <label for="filtro-genero">G√™nero</label>
            <select id="filtro-genero">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="form-field">
            <label for="filtro-diretor">Diretor / Criador</label>
            <select id="filtro-diretor">
              <option value="">Todos</option>
            </select>
          </div>
          <div class="form-field">
            <label for="filtro-franquia">Franquia</label>
            <select id="filtro-franquia">
              <option value="">Todas</option>
            </select>
          </div>
          <div class="form-field">
            <label for="filtro-tipo">Tipo</label>
            <select id="filtro-tipo">
              <option value="">Filmes e S√©ries</option>
              <option value="FILME">Filmes</option>
              <option value="SERIE">S√©ries</option>
            </select>
          </div>
        </div>
      </section>

      <section class="tabs-card">
        <div class="tabs">
          <button class="tab active" data-status="">Todos</button>
          <button class="tab" data-status="ASSISTINDO">Assistindo</button>
          <button class="tab" data-status="ASSISTIDOS">Assistidos</button>
          <button class="tab" data-status="AINDA_NAO_COMECEI">Ainda n√£o comecei</button>
        </div>
      </section>

      <!-- Destaques s√≥ na p√°gina principal -->
      <section class="highlights-grid">
        <div class="highlight-box">
          <h2>‚≠ê Top 10 mais bem avaliados</h2>
          <ul id="lista-top-mais"></ul>
        </div>
        <div class="highlight-box">
          <h2>‚ö†Ô∏è Top 10 menos avaliados</h2>
          <ul id="lista-top-menos"></ul>
        </div>
        <div class="highlight-box">
          <h2>üÜï √öltimos 10 adicionados</h2>
          <ul id="lista-top-recentes"></ul>
        </div>
      </section>

      <!-- Cole√ß√µes de franquias -->
      <section class="franquias-section">
        <h2>Cole√ß√µes de Franquias</h2>
        <p class="small-note">
          Clique em uma franquia para filtrar a lista principal apenas por ela.
        </p>
        <div class="franquias-subtabs">
          <button class="subtab active" data-franquia-tipo="todos">Todas</button>
          <button class="subtab" data-franquia-tipo="FILME">Filmes</button>
          <button class="subtab" data-franquia-tipo="SERIE">S√©ries</button>
        </div>
        <div id="franquias-grid" class="franquias-grid"></div>
      </section>

      <section class="cards-section">
        <h2>Minha lista</h2>
        <div id="midias-list" class="cards-grid"></div>
      </section>
    </main>

    <!-- ===================== VIEW GERIR COLE√á√ÉO ===================== -->
    <main id="view-gerir" class="view">
      <section class="panel">
        <header class="panel-header">
          <div>
            <h2>Gerir Cole√ß√£o</h2>
            <p>Cadastre e edite filmes e s√©ries. Epis√≥dios s√£o geridos em outra tela.</p>
          </div>
          <button id="btn-voltar-principal" class="btn secondary">Voltar para Assistindo</button>
        </header>

        <form id="midia-form" class="form-grid">
          <div class="form-field full">
            <label for="nome">Nome da m√≠dia</label>
            <input id="nome" type="text" placeholder="Ex: Lost, Matrix..." required />
          </div>

          <div class="form-field full">
            <label for="sinopse">Sinopse (descri√ß√£o da m√≠dia)</label>
            <textarea id="sinopse" rows="3" placeholder="Sinopse do filme ou s√©rie"></textarea>
          </div>

          <div class="form-field">
            <label for="diretor">Diretor(es) / Criador(es)</label>
            <input id="diretor" type="text" placeholder="Ex: Wachowski, Damon Lindelof..." />
          </div>

          <div class="form-field">
            <label for="genero">G√™nero</label>
            <input id="genero" type="text" placeholder="Ex: A√ß√£o / Drama / Sci-fi..." />
          </div>

          <div class="form-field">
            <label for="data-lancamento">Data de lan√ßamento</label>
            <input id="data-lancamento" type="date" />
          </div>

          <div class="form-field">
            <label for="ano">Ano de lan√ßamento</label>
            <input id="ano" type="number" min="1900" max="2100" placeholder="Ex: 2025" />
          </div>

          <div class="form-field">
            <label for="streaming">Streaming</label>
            <input id="streaming" type="text" placeholder="Ex: Netflix, Prime Video..." />
          </div>

          <div class="form-field">
            <label for="tipo">Tipo</label>
            <select id="tipo" required>
              <option value="">Selecione...</option>
              <option value="FILME">Filme</option>
              <option value="SERIE">S√©rie</option>
            </select>
          </div>

          <div class="form-field">
            <label for="numero-temporadas">N√∫mero de temporadas (s√©ries)</label>
            <input id="numero-temporadas" type="number" min="0" placeholder="Ex: 6" />
          </div>

          <div class="form-field">
            <label for="numero-episodios">N√∫mero de epis√≥dios (s√©ries)</label>
            <input id="numero-episodios" type="number" min="0" placeholder="Ex: 121" />
          </div>

          <div class="form-field">
            <label for="franquia">Franquia / Cole√ß√£o</label>
            <input id="franquia" type="text" placeholder="Ex: Matrix, Star Wars..." />
          </div>

          <div class="form-field">
            <label for="status">Status</label>
            <select id="status">
              <option value="ASSISTINDO">Assistindo</option>
              <option value="ASSISTIDOS">Assistidos</option>
              <option value="AINDA_NAO_COMECEI">Ainda n√£o comecei</option>
            </select>
          </div>

          <div class="form-field full">
            <label>Avalia√ß√£o (1 a 5 estrelas, com meia estrela)</label>
            <div class="rating-control">
              <div id="midia-rating-stars" class="rating-stars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
              <input id="avaliacao" type="number" min="0" max="5" step="0.5" placeholder="Ex: 4.5" />
            </div>
          </div>

          <div class="form-field full">
            <label for="imagem-url">URL do p√¥ster</label>
            <input id="imagem-url" type="url" placeholder="https://.../poster.jpg" />
          </div>

          <!-- Campo oculto para TMDb ID -->
          <input id="tmdb-id" type="hidden" />

          <div class="form-actions full">
            <button id="btn-salvar-midia" type="submit" class="btn primary">
              <span>üíæ</span> <span>Salvar</span>
            </button>
            <button id="btn-cancelar-edicao-midia" type="button" class="btn ghost" style="display:none;">
              Cancelar edi√ß√£o
            </button>
          </div>
        </form>
      </section>

      <section class="panel">
        <header class="panel-header">
          <div>
            <h2>Buscar na TMDb</h2>
            <p>Preencha automaticamente os dados usando a API da TMDb.</p>
          </div>
        </header>
        <div class="tmdb-search">
          <div class="form-field">
            <label for="tmdb-query">Buscar t√≠tulo na TMDb</label>
            <input id="tmdb-query" type="text" placeholder="Ex: Matrix, Lost..." />
          </div>
          <button id="btn-tmdb-buscar" class="btn secondary">Buscar</button>
        </div>
        <div id="tmdb-resultados" class="tmdb-resultados"></div>
      </section>

      <section class="panel">
        <header class="panel-header">
          <div>
            <h2>Importar / Exportar cole√ß√£o (JSON)</h2>
            <p>Fa√ßa backup ou carregue m√≠dias em massa.</p>
          </div>
        </header>
        <div class="import-export-row">
          <div>
            <button id="btn-export-midias" class="btn secondary">Exportar m√≠dias (JSON)</button>
            <button id="btn-export-modelo-midias" class="btn ghost">Baixar modelo de JSON</button>
          </div>
          <div class="import-group">
            <input id="input-import-midias" type="file" accept="application/json" />
            <button id="btn-import-midias" class="btn primary">Importar JSON</button>
          </div>
        </div>
      </section>

      <section class="panel">
        <header class="panel-header">
          <div>
            <h2>Lista de m√≠dias (para gerenciamento)</h2>
            <p>Edite ou exclua itens da cole√ß√£o.</p>
          </div>
        </header>
        <div class="table-wrapper">
          <table class="midias-table">
            <thead>
              <tr>
                <th>P√¥ster</th>
                <th>Nome</th>
                <th>Tipo</th>
                <th>Streaming</th>
                <th>Status</th>
                <th>Nota</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="tabela-gerir-midias"></tbody>
          </table>
        </div>
      </section>
    </main>

    <!-- ===================== VIEW EPIS√ìDIOS ===================== -->
    <main id="view-episodios" class="view">
      <section class="panel">
        <header class="panel-header">
          <div>
            <h2 id="episodios-titulo">Guia de epis√≥dios</h2>
            <p id="episodios-subtitulo" class="small-note"></p>
          </div>
          <button id="btn-voltar-principal-de-episodios" class="btn secondary">
            ‚Üê Voltar para Assistindo
          </button>
        </header>

        <div id="episodios-resumo" class="episodios-resumo"></div>

        <div class="filters-grid">
          <div class="form-field">
            <label for="filtro-episodio-temporada">Temporada</label>
            <select id="filtro-episodio-temporada">
              <option value="">Todas</option>
            </select>
          </div>
          <div class="form-field">
            <label for="filtro-episodio-status">Status</label>
            <select id="filtro-episodio-status">
              <option value="">Todos</option>
              <option value="ASSISTINDO">Assistindo</option>
              <option value="ASSISTIDOS">Assistidos</option>
              <option value="AINDA_NAO_COMECEI">Ainda n√£o comecei</option>
            </select>
          </div>
        </div>
      </section>

      <section class="panel">
        <header class="panel-header">
          <div>
            <h2>Epis√≥dios por temporada</h2>
            <p>Clique para editar ou cadastrar novos epis√≥dios.</p>
          </div>
          <div class="panel-header-actions">
            <button id="btn-novo-episodio" class="btn primary">+ Novo epis√≥dio</button>
            <button id="btn-export-episodios" class="btn secondary">Exportar epis√≥dios (JSON)</button>
            <label class="btn ghost file-label">
              Importar JSON
              <input id="input-import-episodios" type="file" accept="application/json" hidden />
            </label>
          </div>
        </header>
        <div id="episodios-container" class="episodios-container"></div>
      </section>

      <!-- Modal de epis√≥dio -->
      <div id="episodio-modal-backdrop" class="modal-backdrop hidden">
        <div class="modal">
          <header class="modal-header">
            <h3 id="episodio-modal-titulo">Novo epis√≥dio</h3>
          </header>
          <div class="modal-body">
            <form id="episodio-form" class="form-grid">
              <div class="form-field">
                <label for="episodio-temporada">Temporada</label>
                <input id="episodio-temporada" type="number" min="1" required />
              </div>
              <div class="form-field">
                <label for="episodio-numero">N√∫mero do epis√≥dio</label>
                <input id="episodio-numero" type="number" min="1" required />
              </div>
              <div class="form-field full">
                <label for="episodio-titulo">T√≠tulo</label>
                <input id="episodio-titulo" type="text" placeholder="T√≠tulo do epis√≥dio" />
              </div>
              <div class="form-field full">
                <label for="episodio-resumo">Resumo do epis√≥dio</label>
                <textarea id="episodio-resumo" rows="3" placeholder="Resumo / sinopse do epis√≥dio"></textarea>
              </div>
              <div class="form-field">
                <label for="episodio-status">Status</label>
                <select id="episodio-status">
                  <option value="AINDA_NAO_COMECEI">Ainda n√£o comecei</option>
                  <option value="ASSISTINDO">Assistindo</option>
                  <option value="ASSISTIDOS">Assistidos</option>
                </select>
              </div>
              <div class="form-field full">
                <label>Avalia√ß√£o (1 a 5 estrelas, com meia estrela)</label>
                <div class="rating-control">
                  <div id="episodio-rating-stars" class="rating-stars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
                  <input id="episodio-avaliacao" type="number" min="0" max="5" step="0.5" placeholder="Ex: 4.0" />
                </div>
              </div>
            </form>
          </div>
          <footer class="modal-footer">
            <button id="btn-salvar-episodio" class="btn primary">Salvar</button>
            <button id="btn-cancelar-episodio" class="btn ghost">Cancelar</button>
          </footer>
        </div>
      </div>
    </main>
  </div>

  <!-- Toast de mensagens -->
  <div id="toast" class="toast hidden"></div>

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- App -->
  <script src="app.js"></script>
</body>
</html>
