<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Minha Cole√ß√£o de M√≠dias</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />

    <!-- Supabase JS -->
    <script
      src="https://unpkg.com/@supabase/supabase-js@2.48.0/dist/umd/supabase.min.js"
      defer
    ></script>

    <!-- App JS -->
    <script src="app.js" defer></script>
  </head>
  <body>
    <header class="app-header">
      <div class="logo-title">
        <h1>üé¨ Minha Cole√ß√£o</h1>
        <span class="subtitle">Filmes & S√©ries com TMDb + Supabase</span>
      </div>

      <nav class="main-nav">
        <button class="nav-btn active" data-view="principal">
          P√°gina Principal
        </button>
        <button class="nav-btn" data-view="gerir">Gerir Cole√ß√£o</button>
        <button class="nav-btn" data-view="episodios">Guia de Epis√≥dios</button>
      </nav>
    </header>

    <main class="app-main">
      <!-- MENSAGENS GLOBAIS -->
      <div id="global-message" class="global-message" style="display: none"></div>

      <!-- ===================== VIEW PRINCIPAL ===================== -->
      <section id="view-principal" class="view active">
        <!-- FILTROS E BUSCA -->
        <section class="panel">
          <h2>üì∫ Filtros & Busca</h2>
          <div class="filters-grid">
            <div class="form-field">
              <label for="filtro-busca-nome">Buscar por nome</label>
              <input
                id="filtro-busca-nome"
                type="text"
                placeholder="Ex: Matrix, Lost..."
              />
            </div>

            <div class="form-field">
              <label for="filtro-nota-min">Nota m√≠nima (estrelas)</label>
              <input
                id="filtro-nota-min"
                type="number"
                min="0"
                max="5"
                step="0.5"
                placeholder="Ex: 3.5"
              />
            </div>

            <div class="form-field">
              <label for="filtro-streaming">Streaming</label>
              <select id="filtro-streaming">
                <option value="">Todos</option>
              </select>
            </div>

            <div class="form-field">
              <label for="filtro-ano">Ano</label>
              <select id="filtro-ano">
                <option value="">Todos</option>
              </select>
            </div>

            <div class="form-field">
              <label for="filtro-diretor">Diretor / Criador</label>
              <select id="filtro-diretor">
                <option value="">Todos</option>
              </select>
            </div>

            <div class="form-field">
              <label for="filtro-genero">G√™nero</label>
              <select id="filtro-genero">
                <option value="">Todos</option>
              </select>
            </div>

            <div class="form-field">
              <label for="filtro-franquia">Franquia</label>
              <select id="filtro-franquia">
                <option value="">Todas</option>
              </select>
            </div>

            <div class="form-field">
              <label for="filtro-tipo">Tipo</label>
              <select id="filtro-tipo">
                <option value="">Filmes & S√©ries</option>
                <option value="FILME">S√≥ Filmes</option>
                <option value="SERIE">S√≥ S√©ries</option>
              </select>
            </div>
          </div>

          <div class="filters-actions">
            <button id="btn-aplicar-filtros" class="btn primary">
              Aplicar filtros
            </button>
            <button id="btn-limpar-filtros" class="btn ghost">
              Limpar filtros
            </button>
          </div>
        </section>

        <!-- ABAS DE STATUS -->
        <section class="panel">
          <div class="tabs-header">
            <button
              class="tab-btn active"
              data-status-tab="ASSISTINDO"
            >
              ‚ñ∂ Assistindo
            </button>
            <button class="tab-btn" data-status-tab="ASSISTIDOS">
              ‚úÖ Assistidos
            </button>
            <button
              class="tab-btn"
              data-status-tab="AINDA_NAO_COMECEI"
            >
              ‚è≥ Ainda n√£o comecei
            </button>
          </div>
          <div id="lista-midias" class="cards-grid"></div>
        </section>

        <!-- DESTAQUES (S√ì AQUI NA P√ÅGINA PRINCIPAL) -->
        <section class="panel">
          <h2>‚≠ê Destaques da Sele√ß√£o</h2>
          <div class="highlights-grid">
            <div class="highlight-block">
              <h3>üéñ Top 10 mais bem avaliados</h3>
              <ul id="lista-top-10-mais"></ul>
            </div>
            <div class="highlight-block">
              <h3>‚ö† Top 10 menos avaliados</h3>
              <ul id="lista-top-10-menos"></ul>
            </div>
            <div class="highlight-block">
              <h3>üÜï √öltimos 10 adicionados</h3>
              <ul id="lista-ultimos-10"></ul>
            </div>
          </div>
        </section>

        <!-- FRANQUIAS / COLE√á√ïES -->
        <section class="panel">
          <h2>üìö Cole√ß√µes de Franquias</h2>

          <h3>üé¨ Cole√ß√µes de Filmes</h3>
          <div id="franquias-filmes" class="franquias-grid"></div>

          <h3>üì∫ Cole√ß√µes de S√©ries</h3>
          <div id="franquias-series" class="franquias-grid"></div>

          <p class="hint">
            Clique em um p√¥ster para filtrar a lista principal pela franquia.
          </p>
        </section>
      </section>

      <!-- ===================== VIEW GERIR COLE√á√ÉO ===================== -->
      <section id="view-gerir" class="view">
        <section class="panel">
          <div class="panel-header-inline">
            <h2>üß© Gerir Cole√ß√£o de M√≠dias</h2>
            <div>
              <button id="btn-voltar-principal" class="btn ghost">
                ‚¨Ö Ir para P√°gina Principal
              </button>
            </div>
          </div>

          <!-- BUSCA TMDB -->
          <div class="tmdb-search">
            <h3>üîé Buscar dados na TMDb</h3>
            <div class="tmdb-row">
              <input
                id="tmdb-query"
                type="text"
                placeholder="Digite o nome (ex: Matrix, Lost...)"
              />
              <button id="btn-tmdb-buscar" class="btn secondary">
                Buscar TMDb
              </button>
            </div>
            <div id="tmdb-resultados" class="tmdb-resultados"></div>
          </div>

          <!-- FORM DE M√çDIA -->
          <form id="midia-form" class="midia-form">
            <h3>üì• Cadastro / Edi√ß√£o de M√≠dia</h3>

            <div class="form-grid-2">
              <div class="form-field">
                <label for="nome">Nome</label>
                <input id="nome" type="text" required />
              </div>

              <div class="form-field">
                <label for="tipo">Filme ou S√©rie?</label>
                <select id="tipo">
                  <option value="FILME">Filme</option>
                  <option value="SERIE">S√©rie</option>
                </select>
              </div>
            </div>

            <div class="form-field">
              <label for="sinopse">Sinopse (da m√≠dia)</label>
              <textarea
                id="sinopse"
                rows="3"
                placeholder="Sinopse do filme ou s√©rie"
              ></textarea>
            </div>

            <div class="form-grid-2">
              <div class="form-field">
                <label for="diretor">Diretor(es) / Criador(es)</label>
                <input
                  id="diretor"
                  type="text"
                  placeholder="Diretor(es) ou criador(es)"
                />
              </div>

              <div class="form-field">
                <label for="genero">G√™nero</label>
                <input
                  id="genero"
                  type="text"
                  placeholder="Ex: Drama / Sci-fi"
                />
              </div>
            </div>

            <div class="form-grid-3">
              <div class="form-field">
                <label for="data-lancamento">Data de lan√ßamento</label>
                <input id="data-lancamento" type="date" />
              </div>

              <div class="form-field">
                <label for="ano">Ano</label>
                <input
                  id="ano"
                  type="number"
                  min="1900"
                  max="2100"
                  placeholder="Ex: 1999"
                />
              </div>

              <div class="form-field">
                <label for="streaming">Streaming</label>
                <input
                  id="streaming"
                  type="text"
                  placeholder="Ex: Netflix, Prime..."
                />
              </div>
            </div>

            <div class="form-grid-2">
              <div class="form-field">
                <label for="franquia">Franquia (cole√ß√£o)</label>
                <input
                  id="franquia"
                  type="text"
                  placeholder="Ex: Matrix, Star Wars..."
                />
              </div>

              <div class="form-field">
                <label for="status">Status</label>
                <select id="status">
                  <option value="ASSISTINDO">Assistindo</option>
                  <option value="ASSISTIDOS">Assistidos</option>
                  <option value="AINDA_NAO_COMECEI">
                    Ainda n√£o comecei
                  </option>
                </select>
              </div>
            </div>

            <div class="form-grid-2">
              <div class="form-field">
                <label for="numero-temporadas">
                  N√∫mero de temporadas (s√©ries)
                </label>
                <input
                  id="numero-temporadas"
                  type="number"
                  min="0"
                  placeholder="Ex: 6"
                />
              </div>

              <div class="form-field">
                <label for="numero-episodios">
                  N√∫mero total de epis√≥dios (s√©ries)
                </label>
                <input
                  id="numero-episodios"
                  type="number"
                  min="0"
                  placeholder="Ex: 121"
                />
              </div>
            </div>

            <div class="form-grid-2">
              <div class="form-field">
                <label for="imagem-url">URL do p√¥ster</label>
                <input
                  id="imagem-url"
                  type="url"
                  placeholder="https://..."
                />
              </div>

              <div class="form-field">
                <label for="avaliacao">
                  Avalia√ß√£o (1 a 5 estrelas, aceita 0.5)
                </label>
                <div class="rating-wrapper">
                  <input
                    id="avaliacao"
                    type="number"
                    min="0"
                    max="5"
                    step="0.5"
                    placeholder="Ex: 4.5"
                  />
                  <div id="midia-rating-stars" class="rating-stars">
                    ‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ
                  </div>
                </div>
              </div>
            </div>

            <input id="tmdb-id" type="hidden" />

            <div class="form-actions">
              <button id="btn-salvar-midia" class="btn primary" type="submit">
                <span>üíæ</span>
                <span>Salvar</span>
              </button>
              <button
                id="btn-cancelar-edicao-midia"
                class="btn ghost"
                type="button"
                style="display: none"
              >
                Cancelar edi√ß√£o
              </button>
            </div>
          </form>
        </section>

        <!-- LISTA DE M√çDIAS (GERIR) -->
        <section class="panel">
          <div class="panel-header-inline">
            <h3>üìÇ Lista de M√≠dias (gerenciamento)</h3>
            <div class="import-export-row">
              <button id="btn-export-midias-modelo" class="btn ghost">
                ‚¨á Modelo JSON
              </button>
              <button id="btn-export-midias-json" class="btn secondary">
                ‚¨á Exportar m√≠dias
              </button>
              <label class="btn file-btn">
                ‚¨Ü Importar m√≠dias
                <input
                  id="input-import-midias"
                  type="file"
                  accept="application/json"
                  hidden
                />
              </label>
            </div>
          </div>

          <div id="lista-midias-gerir" class="midias-table"></div>
        </section>
      </section>

      <!-- ===================== VIEW EPIS√ìDIOS ===================== -->
      <section id="view-episodios" class="view">
        <section class="panel">
          <div class="panel-header-inline">
            <h2>üìí Guia de Epis√≥dios</h2>
            <button id="btn-voltar-principal-ep" class="btn ghost">
              ‚¨Ö Ir para P√°gina Principal
            </button>
          </div>

          <div class="form-field">
            <label for="select-serie-episodios">
              Escolha uma s√©rie para gerenciar os epis√≥dios
            </label>
            <select id="select-serie-episodios">
              <option value="">Selecione uma s√©rie</option>
            </select>
          </div>

          <div id="resumo-serie-episodios" class="serie-resumo-box"></div>

          <!-- IMPORT / EXPORT EPIS√ìDIOS -->
          <div class="import-export-row">
            <button id="btn-export-episodios-modelo" class="btn ghost">
              ‚¨á Modelo JSON Epis√≥dios
            </button>
            <button id="btn-export-episodios-json" class="btn secondary">
              ‚¨á Exportar epis√≥dios
            </button>
            <label class="btn file-btn">
              ‚¨Ü Importar epis√≥dios
              <input
                id="input-import-episodios"
                type="file"
                accept="application/json"
                hidden
              />
            </label>
          </div>
        </section>

        <!-- FORM EPIS√ìDIO -->
        <section class="panel">
          <form id="episodio-form" class="episodio-form">
            <h3>‚ûï Cadastro / Edi√ß√£o de Epis√≥dio</h3>

            <div class="form-grid-3">
              <div class="form-field">
                <label for="episodio-temporada">Temporada</label>
                <input
                  id="episodio-temporada"
                  type="number"
                  min="1"
                  placeholder="1"
                />
              </div>

              <div class="form-field">
                <label for="episodio-numero">Epis√≥dio (T00E00)</label>
                <input
                  id="episodio-numero"
                  type="text"
                  placeholder="T01E01"
                />
              </div>

              <div class="form-field">
                <label for="episodio-status">Status</label>
                <select id="episodio-status">
                  <option value="AINDA_NAO_COMECEI">
                    Ainda n√£o comecei
                  </option>
                  <option value="ASSISTINDO">Assistindo</option>
                  <option value="ASSISTIDOS">Assistidos</option>
                </select>
              </div>
            </div>

            <div class="form-field">
              <label for="episodio-titulo">T√≠tulo do epis√≥dio</label>
              <input
                id="episodio-titulo"
                type="text"
                placeholder="Nome do epis√≥dio"
              />
            </div>

            <div class="form-field">
              <label for="episodio-resumo">Resumo do epis√≥dio</label>
              <textarea
                id="episodio-resumo"
                rows="3"
                placeholder="Resumo / sinopse do epis√≥dio"
              ></textarea>
            </div>

            <div class="form-field">
              <label for="episodio-avaliacao">
                Avalia√ß√£o (1 a 5 estrelas, aceita 0.5)
              </label>
              <div class="rating-wrapper">
                <input
                  id="episodio-avaliacao"
                  type="number"
                  min="0"
                  max="5"
                  step="0.5"
                  placeholder="Ex: 4"
                />
                <div id="episodio-rating-stars" class="rating-stars">
                  ‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ
                </div>
              </div>
            </div>

            <div class="form-actions">
              <button id="btn-salvar-episodio" class="btn primary" type="submit">
                üíæ Salvar epis√≥dio
              </button>
              <button
                id="btn-cancelar-edicao-episodio"
                class="btn ghost"
                type="button"
                style="display: none"
              >
                Cancelar edi√ß√£o
              </button>
            </div>
          </form>
        </section>

        <!-- LISTAGEM DE EPIS√ìDIOS AGRUPADOS -->
        <section class="panel">
          <h3>üßæ Epis√≥dios cadastrados</h3>
          <div id="lista-episodios-agrupados" class="episodios-agrupados"></div>
        </section>
      </section>
    </main>
  </body>
</html>
